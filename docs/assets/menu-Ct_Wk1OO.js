import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css                   */let r=0,s=[];document.addEventListener("DOMContentLoaded",()=>{p(),d(),j(),L(),w()});function w(){document.getElementById("formNotificaciones").addEventListener("submit",C),document.querySelectorAll("button").forEach(e=>{e.textContent.includes("Canjear")&&!e.onclick&&e.addEventListener("click",h)}),document.addEventListener("click",e=>{e.target.id==="modalNotificaciones"&&l(),e.target.id==="modalCupones"&&g(),e.target.id==="modalCanjear"&&u()})}function C(t){t.preventDefault();const e={puntos:this.puntos.checked,promociones:this.promociones.checked,productos:this.productos.checked,habitos:this.habitos.checked};localStorage.setItem("notificaciones",JSON.stringify(e)),c("‚úÖ Preferencias guardadas"),l()}function p(){r=parseInt(localStorage.getItem("puntosUsuario"))||123,s=JSON.parse(localStorage.getItem("historialCompras"))||[],s.length===0&&(s=[{id:1,fecha:"2024-09-15",producto:"Botella Reutilizable",precio:15e3,puntos:15,carbono:-2.3,categoria:"Sustentable"},{id:2,fecha:"2024-09-20",producto:"Panel Solar Port√°til",precio:85e3,puntos:50,carbono:-15.8,categoria:"Energ√≠a Renovable"}],localStorage.setItem("historialCompras",JSON.stringify(s)))}function d(){const t=s.reduce((n,i)=>n+Math.abs(i.carbono),0),e=t/22,o={puntosDisplay:r,carbonoEvitado:t.toFixed(1),arbolesEquiv:e.toFixed(1)};Object.entries(o).forEach(([n,i])=>{const a=document.getElementById(n);a&&E(a,i)})}function E(t,e,o=1500){const i=e/(o/50);let a=0;const y=setInterval(()=>{a+=i,a>=e&&(a=e,clearInterval(y)),t.textContent=typeof e=="string"?a.toFixed(1):Math.floor(a)},50)}function j(){document.querySelectorAll(".animate-fade-in").forEach((e,o)=>{e.style.opacity="0",e.style.transform="translateY(30px)",setTimeout(()=>{e.style.transition="all 0.6s ease-out",e.style.opacity="1",e.style.transform="translateY(0)"},o*200)})}function L(){window.addEventListener("resize",()=>{m()}),m()}function m(){const t=window.innerWidth>=768&&window.innerWidth<1024;window.innerWidth>=1024?(document.body.classList.add("desktop-mode"),document.body.classList.remove("mobile-mode","tablet-mode")):t?(document.body.classList.add("tablet-mode"),document.body.classList.remove("mobile-mode","desktop-mode")):(document.body.classList.add("mobile-mode"),document.body.classList.remove("tablet-mode","desktop-mode"))}window.addEventListener("focus",()=>{p(),d()});function I(){const t=document.querySelectorAll("img[data-src]"),e=new IntersectionObserver((o,n)=>{o.forEach(i=>{if(i.isIntersecting){const a=i.target;a.src=a.dataset.src,a.classList.remove("lazy"),n.unobserve(a)}})});t.forEach(o=>e.observe(o))}function x(){alert("El reporte de impacto ambiental se exportar√° en formato PDF o Excel.")}function S(){navigator.share?navigator.share({title:"Mi Impacto Ambiental",text:"He ahorrado CO‚ÇÇ y contribuido al medioambiente üå±",url:window.location.href}).then(()=>console.log("Compartido con √©xito")).catch(t=>console.log("Error al compartir:",t)):alert("La opci√≥n de compartir no est√° disponible en este navegador.")}I();"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered: ",t)}).catch(t=>{console.log("SW registration failed: ",t)})});function M(){document.getElementById("userMenu").classList.toggle("hidden")}function N(){document.getElementById("modalNotificaciones").classList.remove("hidden"),document.getElementById("userMenu").classList.add("hidden")}function l(){document.getElementById("modalNotificaciones").classList.add("hidden")}function c(t){const e=document.createElement("div");e.className="fixed bottom-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg animate-bounce",e.innerText=t,document.body.appendChild(e),setTimeout(()=>e.remove(),4e3)}setTimeout(()=>{(JSON.parse(localStorage.getItem("notificaciones"))||{}).puntos&&c("üéâ Has sumado 50 Puntos Verdes en tu √∫ltima compra")},5e3);function k(){document.getElementById("modalCupones").classList.remove("hidden"),b()}function g(){document.getElementById("modalCupones").classList.add("hidden")}let f=[{id:1,nombre:"10% Descuento Walmart",puntos:50,activo:!0,app:"Walmart"},{id:2,nombre:"5% Descuento EcoPuntos",puntos:20,activo:!0,app:"EcoPuntos"},{id:3,nombre:"15% Descuento Walmart",puntos:100,activo:!1,app:"Walmart"}];function b(){const t=document.getElementById("listaCupones");t.innerHTML="",f.forEach(e=>{const o=r>=e.puntos&&e.activo;t.innerHTML+=`
            <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                <div>
                    <div class="font-semibold">${e.nombre}</div>
                    <div class="text-xs text-gray-500">Requiere ${e.puntos} puntos ‚Ä¢ ${e.app}</div>
                </div>
                <button ${o?"":"disabled"} 
                    class="px-3 py-1 rounded-lg text-white ${o?"bg-green-500 hover:bg-green-600":"bg-gray-300 cursor-not-allowed"}"
                    onclick="canjearCupon(${e.id})">
                    Canjear
                </button>
            </div>
        `})}function B(t){const e=f.find(o=>o.id===t);if(!e||!e.activo){alert("‚ùå Este cup√≥n ya no est√° disponible.");return}if(r<e.puntos){alert("‚ùå No tienes puntos suficientes para canjear este cup√≥n.");return}r-=e.puntos,localStorage.setItem("puntosUsuario",r),alert(`‚úÖ Cup√≥n canjeado: ${e.nombre} (${e.app})`),b(),d()}function h(){const t=document.getElementById("modalCanjear"),e=document.getElementById("puntosModal");e.textContent=r,t.classList.remove("hidden"),v()}function u(){document.getElementById("modalCanjear").classList.add("hidden")}function v(){document.querySelectorAll('#modalCanjear button[onclick*="canjearProducto"]').forEach(e=>{const o=e.getAttribute("onclick").match(/canjearProducto\((\d+),/);if(o){const n=parseInt(o[1]);if(r<n)e.disabled=!0,e.classList.remove("bg-blue-500","bg-green-500","bg-yellow-500","bg-red-500","bg-purple-500"),e.classList.add("bg-gray-300","cursor-not-allowed"),e.innerHTML=`${n} Puntos`;else{e.disabled=!1,e.classList.remove("bg-gray-300","cursor-not-allowed");const i=P(n);e.classList.add(i),e.innerHTML=`${n} Puntos`}}})}function P(t){return{5:"bg-blue-500 hover:bg-blue-600",10:"bg-green-500 hover:bg-green-600",20:"bg-yellow-500 hover:bg-yellow-600",30:"bg-red-500 hover:bg-red-600",40:"bg-purple-500 hover:bg-purple-600"}[t]||"bg-gray-500 hover:bg-gray-600"}function $(t,e){if(r<t){c("‚ùå No tienes puntos suficientes para canjear este producto");return}confirm(`¬øEst√°s seguro de canjear ${t} puntos por: ${e}?`)&&(r-=t,localStorage.setItem("puntosUsuario",r),d(),document.getElementById("puntosModal").textContent=r,v(),c(`‚úÖ ¬°Canje exitoso! Has canjeado ${t} puntos por: ${e}`),D(e,t),setTimeout(()=>{u()},2e3))}function D(t,e){const o=JSON.parse(localStorage.getItem("historialCanjes"))||[],n={id:Date.now(),fecha:new Date().toISOString(),producto:t,puntos:-e,tipo:"canje"};o.unshift(n),localStorage.setItem("historialCanjes",JSON.stringify(o))}window.toggleUserMenu=M;window.abrirNotificaciones=N;window.cerrarNotificaciones=l;window.exportarReporte=x;window.compartirReporte=S;window.abrirCupones=k;window.cerrarCupones=g;window.canjearCupon=B;window.abrirModalCanjear=h;window.cerrarModalCanjear=u;window.canjearProducto=$;
