import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css                   */let b=0,r=[];function s(o){return o.toString().replace(".",",")}function f(){const o=new Date;return`${["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][o.getMonth()]} ${o.getFullYear()}`}const a={meses:["Julio","Agosto","Septiembre","Octubre"],años:[2025],puntosPorMes:[85,92,156,123],impactoPorMes:[3.2,4.1,7.8,5.8],categorias:["Productos Reutilizables","Energía Renovable","Alimentación Orgánica","Transporte Ecológico"],porcentajesImpacto:[35,28,22,15]};document.addEventListener("DOMContentLoaded",()=>{g(),m(),h()});function g(){b=parseInt(localStorage.getItem("puntosUsuario"))||123,r=JSON.parse(localStorage.getItem("historialCompras"))||[],r.length===0&&(r=[{id:1,fecha:"2025-10-15",producto:"Botella de Agua Reutilizable",precio:15e3,puntos:15,carbono:-2.3,categoria:"Sustentable"},{id:2,fecha:"2025-10-08",producto:"Panel Solar Portátil",precio:85e3,puntos:50,carbono:-15.8,categoria:"Energía Renovable"}],localStorage.setItem("historialCompras",JSON.stringify(r)))}function m(){document.getElementById("periodoActual").textContent=`Período: ${f()}`,document.getElementById("graficoFechas").textContent=`${a.meses[0]} - ${a.meses[a.meses.length-1]} ${a.años[0]}`;const o=r.reduce((c,d)=>c+Math.abs(d.carbono),0),t=o/22,e=r.reduce((c,d)=>c+d.precio*.15,0);n("totalPuntos",b),n("carbonoEvitado",s(o.toFixed(1))),n("totalCompras",r.length),n("ahorroTotal",`$${e.toLocaleString("es-CO")}`);const i=a.puntosPorMes.reduce((c,d)=>c+d,0)/a.puntosPorMes.length,l=a.puntosPorMes[a.puntosPorMes.length-2],u=a.puntosPorMes[a.puntosPorMes.length-1],p=(u-l)/l*100;n("puntosMesActual",u),n("promedioMensual",s(i.toFixed(1))),n("crecimientoMensual",`${p>0?"+":""}${s(p.toFixed(1))}%`),n("co2Evitado",s(o.toFixed(1))),n("arbolesEquiv",s(t.toFixed(2))),n("aguaAhorrada",s((o*21.6).toFixed(1))),n("residuosReducidos",s((o*.4).toFixed(1))),x()}function n(o,t){const e=document.getElementById(o);e&&(e.textContent=t)}function x(){const o=document.getElementById("historialCompras"),t=document.getElementById("sinCompras");if(r.length===0){o.classList.add("hidden"),t.classList.remove("hidden");return}o.innerHTML=r.map(e=>{const i=new Date(e.fecha).toLocaleDateString("es-CO",{day:"numeric",month:"long",year:"numeric"}),l=e.carbono<0?"text-green-600":"text-red-600",u=e.carbono<0?"fa-leaf":"fa-exclamation-triangle";return`
            <div class="border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow">
                <div class="flex justify-between items-start mb-3">
                    <div class="flex-1">
                        <h4 class="font-semibold text-gray-800 text-lg">${e.producto}</h4>
                        <p class="text-sm text-gray-600">${i}</p>
                        <div class="flex items-center space-x-4 mt-2">
                            <span class="text-sm text-gray-600">Categoría: <strong>${e.categoria}</strong></span>
                            <span class="text-sm text-green-600">+${e.puntos} puntos</span>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="font-bold text-xl text-gray-800">$${e.precio.toLocaleString("es-CO")}</div>
                        <div class="text-sm ${l} flex items-center justify-end mt-1">
                            <i class="fas ${u} mr-1"></i>
                            ${s(Math.abs(e.carbono).toFixed(1))} kg CO₂
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 rounded-lg p-3">
                    <div class="flex justify-between text-sm">
                        <span class="text-gray-600">Impacto ambiental:</span>
                        <span class="${l} font-semibold">
                            ${e.carbono<0?"Reducción":"Emisión"} de ${s(Math.abs(e.carbono).toFixed(1))} kg CO₂
                        </span>
                    </div>
                    <div class="flex justify-between text-sm mt-1">
                        <span class="text-gray-600">Equivalencia forestal:</span>
                        <span class="text-blue-600 font-semibold">${s((Math.abs(e.carbono)/22).toFixed(3))} árboles</span>
                    </div>
                </div>
            </div>
        `}).join("")}function h(){y(),v(),C()}function y(){const o=document.getElementById("graficoMensual").getContext("2d");new Chart(o,{type:"line",data:{labels:a.meses,datasets:[{label:"Puntos Verdes Ganados",data:a.puntosPorMes,borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",borderWidth:3,fill:!0,tension:.4,pointBackgroundColor:"#10b981",pointBorderColor:"#ffffff",pointBorderWidth:3,pointRadius:6,pointHoverRadius:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:`Evolución de Puntos Ecológicos - ${a.años[0]}`,font:{size:16,weight:"bold"}},legend:{display:!0,position:"bottom"},tooltip:{callbacks:{label:function(t){const e=s(t.parsed.y),i=(t.parsed.y/150*100).toFixed(1);return`Puntos: ${e} (${s(i)}% de la meta)`}}}},scales:{y:{beginAtZero:!0,max:200,ticks:{callback:function(t){return s(t)+" pts"}},title:{display:!0,text:"Puntos Verdes"}},x:{title:{display:!0,text:"Meses - 2025"}}}}})}function v(){const o=document.getElementById("graficoImpacto").getContext("2d");new Chart(o,{type:"doughnut",data:{labels:a.categorias,datasets:[{data:a.porcentajesImpacto,backgroundColor:["#10b981","#3b82f6","#f59e0b","#8b5cf6"],borderWidth:2,borderColor:"#ffffff"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Distribución del Impacto Ambiental por Categoría",font:{size:14,weight:"bold"}},legend:{position:"bottom"},tooltip:{callbacks:{label:function(t){const e=s(t.parsed);return`${t.label}: ${e}%`}}}}}})}function C(){const o=document.getElementById("graficoComparativo").getContext("2d");new Chart(o,{type:"bar",data:{labels:a.meses,datasets:[{label:"Puntos Ganados",data:a.puntosPorMes,backgroundColor:"rgba(16, 185, 129, 0.8)",borderColor:"#10b981",borderWidth:1},{label:"CO₂ Evitado (kg)",data:a.impactoPorMes,backgroundColor:"rgba(59, 130, 246, 0.8)",borderColor:"#3b82f6",borderWidth:1,yAxisID:"y1"}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{title:{display:!0,text:"Comparativa Mensual: Puntos vs Impacto Ambiental",font:{size:14,weight:"bold"}},legend:{position:"bottom"},tooltip:{callbacks:{label:function(t){const e=s(t.parsed.y),i=t.datasetIndex===0?" puntos":" kg CO₂";return`${t.dataset.label}: ${e}${i}`}}}},scales:{y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Puntos Verdes"},ticks:{callback:function(t){return s(t)}}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"CO₂ Evitado (kg)"},ticks:{callback:function(t){return s(t)}},grid:{drawOnChartArea:!1}},x:{title:{display:!0,text:"Meses - 2025"}}}}})}window.addEventListener("focus",()=>{g(),m()});
